-- CREATE FUNCTION FOR FINDING FEEDBACK BY ID SUFFIX\n-- This fixes the UUID LIKE operation issue in the upvoting system\n-- Run this in your Supabase SQL editor\n\n-- Create function to find feedback submissions by ID suffix\nCREATE OR REPLACE FUNCTION find_feedback_by_id_suffix(id_suffix TEXT)\nRETURNS TABLE(id UUID, subject TEXT) AS $$\nBEGIN\n    RETURN QUERY\n    SELECT \n        fs.id,\n        fs.subject\n    FROM feedback_submissions fs\n    WHERE fs.id::TEXT LIKE '%' || id_suffix;\nEND;\n$$ LANGUAGE plpgsql SECURITY DEFINER;\n\n-- Grant execution permissions\nGRANT EXECUTE ON FUNCTION find_feedback_by_id_suffix TO authenticated;\nGRANT EXECUTE ON FUNCTION find_feedback_by_id_suffix TO anon;\n\n-- Test the function (optional)\n-- SELECT * FROM find_feedback_by_id_suffix('4de9be');\n\nSELECT 'Function created successfully! Upvoting should now work.' as status;